import hashlib
import os

# Directory
DIRECTORY = "./malware_detection/not_hashed"


def calculate_md5():
    data = []
    for filename in os.listdir(DIRECTORY):
        # Get the file path
        file_path = os.path.join(DIRECTORY, filename)

        # Open the file, read the contents, and calculate the MD5 hash
        with open(file_path, "rb") as f:
            file_hash = hashlib.md5()
            while chunk := f.read(8192):
                file_hash.update(chunk)

            result_tuple = (file_hash.hexdigest(), filename)
            data.append(result_tuple)

    return data


