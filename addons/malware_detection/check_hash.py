import sqlite3
# from .get_file_hash import calculate_md5

db_file = "./HashDB"
hashes = sqlite3.connect(db_file)
db_cursor = hashes.cursor()

# Create the table if it doesn't exist
# db_cursor.execute(
#     "CREATE TABLE IF NOT EXISTS HashDB (hash TEXT)"
# )

# # Insert a sample row into the table
# db_cursor.execute(
#     "INSERT INTO HashDB (hash) VALUES (?)",
#     ("ef7f88d9c7c47c48280bf222627bfe04",)
# )
# hashes.commit()


def classify_malware(target_hash):
    print(target_hash)
    query = "SELECT hash FROM HashDB WHERE hash = ?"
    exist = db_cursor.execute(query, (target_hash,)).fetchall()

    if len(exist) > 0:
        return "malware"
    return "benign"


# FOR LATER USE
# def get_all_data():
#     results = db_cursor.execute(
#         "SELECT * FROM HashDB",
#     ).fetchall()

#     for result in results:
#         print(len(result[0]))


# def add_data(hash, filename):
#     db_cursor.execute(
#         f"INSERT INTO HashDB VALUES (\"{hash}\", \"{filename}\")",
#     )




# if __name__ == "__main__":
#     # get_all_data()
#     data = [
#         ("36828b9c630a86bfd5babd2bdef106fc", "CD_ROM.vbs"),
#         ("aa991d6e29bf8eb4c1b56c599dffce0a", "EICAR.com"),
#         ("a33aa0ddbcbf2b96f5251b842bd45a63", "install.bat"),
#         ("bd8772f0ab3d5e490a28bc0c140faf1f", "setup.bat"),
#         ("e143d98d4a58a8e839827ea6ccda94fa", "generate.bat"),
#         ("51742608d12a9a303c424952635174a4", "check.bat"),
#         ("7f5c15475f2851139ae4cfda2acc41a8", "start.bat"),
#         ("ef7f88d9c7c47c48280bf222627bfe04", "setup.sh"),
#         ("fdcdcbfd7b88cb7851c6019520466a66", "crack.bat"),
#         ("15d84236a0f4bff0d5c088adf8390cc4", "play.bat"),
#     ]

#     for hash, filename in data:
#         print(hash, filename)
#         add_data(hash, filename)

#     data = calculate_md5()
#     for hash, filename in data:
#         print(hash, filename)
#         add_data(hash, filename)

#     hashes.commit()


